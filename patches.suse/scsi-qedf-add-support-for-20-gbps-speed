From: Saurav Kashyap <skashyap@marvell.com>
Date: Fri, 23 Aug 2019 02:52:37 -0700
Subject: scsi: qedf: Add support for 20 Gbps speed
Patch-mainline: v5.4-rc1
Git-commit: 931285e0123c4f380a9e2ff06434c8307b92b726
References: bsc#1149976

The current code doeesn't support 20Gbps speed for current and supported
speed. Add support for it.

Signed-off-by: Saurav Kashyap <skashyap@marvell.com>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
Acked-by: Lee Duncan <lduncan@suse.com>
---
 drivers/scsi/qedf/qedf_main.c |    5 +++++
 1 file changed, 5 insertions(+)

--- a/drivers/scsi/qedf/qedf_main.c
+++ b/drivers/scsi/qedf/qedf_main.c
@@ -468,6 +468,9 @@ static void qedf_update_link_speed(struc
 	case 10000:
 		lport->link_speed = FC_PORTSPEED_10GBIT;
 		break;
+	case 20000:
+		lport->link_speed = FC_PORTSPEED_20GBIT;
+		break;
 	case 25000:
 		lport->link_speed = FC_PORTSPEED_25GBIT;
 		break;
@@ -499,6 +502,8 @@ static void qedf_update_link_speed(struc
 		lport->link_supported_speeds |= FC_PORTSPEED_50GBIT;
 	if (link->supported_caps & SUPPORTED_100000baseKR4_Full)
 		lport->link_supported_speeds |= FC_PORTSPEED_100GBIT;
+	if (link->supported_caps & QED_LM_20000baseKR2_Full_BIT)
+		lport->link_supported_speeds |= FC_PORTSPEED_20GBIT;
 	fc_host_supported_speeds(lport->host) = lport->link_supported_speeds;
 }
 
